---
import GitHub from "./icons/GitHub.astro"
import NextJS from "./icons/NextJS.astro"
import Tailwind from "./icons/Tailwind.astro"
import Django from "./icons/Django.astro"
import Link from "./icons/Link.astro"
import Html from "./icons/Html.astro"
import Css from "./icons/Css.astro"
import Laravel from "./icons/Laravel.astro"

import Vue from "./icons/Vue.astro"
import LinkButton from "./LinkButton.astro"

const TAGS = {
  NEXT: {
    name: "Next.js",
    class: "bg-black text-white",
    icon: NextJS,
  },
  DJANGO: {
    name: "Django",
    class: "bg-[#092E20] text-white",
    icon: Django,
  },
  TAILWIND: {
    name: "Tailwind CSS",
    class: "bg-[#38BDF8] text-white",
    icon: Tailwind,
  },
  HTML: {
    name: "HTML",
    class: "bg-[#E44D26] text-white",
    icon: Html,
  },
  CSS: {
    name: "CSS",
    class: "bg-[#264DE4] text-white",
    icon: Css,
  },
  LARAVEL: {
    name: "Laravel",
    class: "bg-[#FF2D20] text-white",
    icon: Laravel,
  },
  VUE: {
    name: "Vue.js",
    class: "bg-[#42b883] text-white",
    icon: Vue,
  },
}


const PROJECTS = [
  {
    title: "Sistema de reservas para el Gad de San Andres",
    description: "Sistema de reservas de habitaciones o guías turísticos, con un asistente virtual integrado mediante Dialogflow. Desarrollado desde cero con Django, Python y Bootstrap CSS.",
    link: "",
    github: "https://github.com/YaibeehBA/voyaventura-sanandres",
    image: "/projects/app1.webp",
    tags: [TAGS.DJANGO, TAGS.TAILWIND],
  },
  {
    title: "NewBlessing - Sistema de pedidos de camisas",
    description: "Aplicación web desarrollada para gestionar los pedidos de camisas de la empresa NewBlessing. Permite administrar productos, clientes y pedidos de forma eficiente. Desarrollado desde cero con Laravel para el backend y Vue.js para el frontend.",
    link: "",
    github: "https://github.com/YaibeehBA/pedidos-vue-fronted", 
    githubBackend: "https://github.com/YaibeehBA/pedidos-laravel-backend", 
    image: "/projects/app3.webp", 
    tags: [TAGS.LARAVEL, TAGS.VUE],
  },
  {
    title: "Blog de Nutrición Profesional",
    description: "Sitio web informativo diseñado para un nutricionista profesional. Se comparten artículos, consejos y recetas saludables, enfocados en una vida balanceada. Desarrollado con HTML, CSS y JavaScript para una experiencia simple y rápida.",
    link: "", 
    github: "https://github.com/YaibeehBA/Nutricion-y-Dietetica",
    image: "/projects/app2.webp", 
    tags: [TAGS.HTML, TAGS.CSS],
  },
  

]
---
<style>
  .carousel-container {
    position: relative;
    width: 100%;
    overflow: hidden;
  }
  .carousel-inner {
    display: flex;
    transition: transform 0.5s ease;
    width: 100%;
  }
  .carousel-item {
    min-width: 100%;
    box-sizing: border-box;
    padding: 0 1rem;
  }
  .arrow-button {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0, 0, 0, 0.7);
    color: white;
    border: 2px solid white;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    font-size: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 10;
    opacity: 0;
    transition: opacity 0.3s ease, transform 0.3s ease;
  }
  .carousel-container:hover .arrow-button {
    opacity: 1;
  }
  .arrow-button:hover {
    background: rgba(0, 0, 0, 0.9);
    transform: translateY(-50%) scale(1.1);
  }
  .arrow-button.prev {
    left: 1rem;
  }
  .arrow-button.next {
    right: 1rem;
  }
  .tag-with-icon {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    position: relative;
  }
  .tag-with-icon .icon-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 50%;
    padding: 2px;
    margin-right: 4px;
  }
  .tag-with-icon .icon-wrapper svg {
    width: 14px;
    height: 14px;
    filter: drop-shadow(0 0 1px rgba(0,0,0,0.3));
  }
  .project-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
    align-items: center;
  }
  @media (max-width: 768px) {
    .arrow-button {
      opacity: 1 !important; /* Siempre visibles en móvil */
      width: 36px;
      height: 36px;
      font-size: 18px;
    }
    .arrow-button.prev {
      left: 0.5rem;
    }
    .arrow-button.next {
      right: 0.5rem;
    }
  }
</style>

<div class="carousel-container group">
  <!-- Carrusel -->
  <div class="carousel-inner" id="carousel">
    {
      PROJECTS.map(({ image, title, description, tags, link, github, githubBackend }) => (
        <article class="carousel-item">
          {/* Contenedor de imagen */}
          <div class="relative shadow-xl overflow-hidden rounded-xl w-full h-56 md:h-64 lg:h-72 hover:-translate-y-1 hover:shadow-2xl transition-all">
            <img 
              src={image} 
              alt={title} 
              class="object-cover w-full h-full" 
              loading="lazy" 
              width="600" 
              height="400"
            />
          </div>

          {/* Contenedor de información */}
          <div class="w-full mt-6">
            <h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100">
              {title}
            </h3>
            <ul class="flex flex-wrap mt-2 gap-2">
              {tags.map((tag) => (
                <li>
                  <span class={`tag-with-icon rounded-full text-xs ${tag.class} py-1 px-3`}>
                    <span class="icon-wrapper">
                      <tag.icon />
                    </span>
                    {tag.name}
                  </span>
                </li>
              ))}
            </ul>
            <p class="mt-2 text-gray-700 dark:text-gray-400">{description}</p>
            <footer class="project-buttons mt-4">
              {github && !githubBackend && (
                <LinkButton href={github}>
                  <GitHub class="size-5 mr-1" />
                  Ver código
                </LinkButton>
              )}
              {github && githubBackend && (
                <>
                  <LinkButton href={github}>
                    <GitHub class="size-5 mr-1" />
                    Frontend
                  </LinkButton>
                  <LinkButton href={githubBackend}>
                    <GitHub class="size-5 mr-1" />
                    Backend
                  </LinkButton>
                </>
              )}
              {link && (
                <LinkButton href={link}>
                  <Link class="size-5 mr-1" />
                  Ver demo
                </LinkButton>
              )}
            </footer>
          </div>
        </article>
      ))
    }
  </div>
  
  <!-- Flechas de navegación -->
  <button 
    class="arrow-button prev"
    aria-label="Anterior"
    id="prevButton"
  >
    &lt;
  </button>
  
  <button 
    class="arrow-button next"
    aria-label="Siguiente"
    id="nextButton"
  >
    &gt;
  </button>
</div>

<script is:inline>
  document.addEventListener('DOMContentLoaded', () => {
    const prevButton = document.getElementById('prevButton');
    const nextButton = document.getElementById('nextButton');
    const carousel = document.getElementById('carousel');
    const items = carousel.querySelectorAll('.carousel-item');
    let currentIndex = 0;
    
    if (!carousel || items.length === 0) return;
    
    const updateCarousel = () => {
      const itemWidth = items[0].clientWidth;
      carousel.style.transform = `translateX(-${currentIndex * itemWidth}px)`;
    };
    
    const navigate = (direction) => {
      if (direction === 'next') {
        currentIndex = (currentIndex + 1) % items.length;
      } else {
        currentIndex = (currentIndex - 1 + items.length) % items.length;
      }
      updateCarousel();
    };
    
    // Inicializar
    updateCarousel();
    
    // Event listeners
    if (prevButton) prevButton.addEventListener('click', () => navigate('prev'));
    if (nextButton) nextButton.addEventListener('click', () => navigate('next'));
    
    // Manejar redimensionamiento
    window.addEventListener('resize', updateCarousel);
  });
</script>